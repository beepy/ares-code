#include "Alt Preferences.h"Boolean EasyOpenPreferenceFile( StringPtr fileName, OSType creator, OSType type,							short *preferenceRefNum)							{	OSErr	error;	short	preferenceFolderRefNum = 0, volumeRefNum = 0, applicationRefNum = CurResFile();	Handle	tempData = nil;	long	dirID = 0;	FSSpec	spec;	Boolean	result = false;		*preferenceRefNum = 0;		error = FindFolder( kOnSystemDisk, kPreferencesFolderType, true, &volumeRefNum,						&dirID);	if ( error != noErr) return( false);	error = FSMakeFSSpec( volumeRefNum, dirID, fileName, &spec);		*preferenceRefNum = FSpOpenResFile( &spec, fsRdWrPerm);	if ( ResError() != noErr) // file doesn't seem to exist	{		*preferenceRefNum = 0;		error = FSpCreate( &spec, creator, type, smRoman);		if ( error != noErr) return( false);		FSpCreateResFile( &spec, creator, type, smRoman);		if ( ResError() != noErr) return( false);				*preferenceRefNum = FSpOpenResFile( &spec, fsRdWrPerm);		if ( ResError() == noErr)		{			UseResFile( applicationRefNum);			return( true);		}	} else	{		UseResFile( applicationRefNum);		return( true); // file already existed	}	UseResFile( applicationRefNum);	return( true); // never executed}